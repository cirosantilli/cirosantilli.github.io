<!doctype html>
<html lang=en>
<head>
<meta charset=utf-8>
<title>React - Ciro Santilli</title>
<meta property="og:title" content="React - Ciro Santilli">
<meta property="og:type" content="website">
<meta property="og:image" content="https://raw.githubusercontent.com/cirosantilli/media/master/ID_photo_of_Ciro_Santilli_taken_in_2013_square_398.jpg">
<meta property="og:url" content="https://cirosantilli.com/react">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.1/css/all.min.css" integrity="sha512-9my9Mb2+0YO+I4PUCSwUYO7sEK21Y0STBAiFEYoWtd2VzLEZZ4QARDrZ30hdM1GlioHJ8o8cWQiy8IAb1hy/Hg==" crossorigin="anonymous" referrerpolicy="no-referrer">
<link rel="canonical" href="https://ourbigbook.com/cirosantilli/react">
<style>@import "_obb/dist/ourbigbook.css";

</style>
<link rel="stylesheet" type="text/css" href="_raw/main.css">
<link rel="shortcut icon" type="image/x-icon" href="https://raw.githubusercontent.com/cirosantilli/media/master/ID_photo_of_Ciro_Santilli_taken_in_2013_square_398.jpg">
</head>
<body>
<header>
<div class="brand-group">
<a href="." class="brand"><img src="https://raw.githubusercontent.com/cirosantilli/media/master/ID_photo_of_Ciro_Santilli_taken_in_2013_right_eye_200_100.jpg" loading="lazy" alt="ID photo of Ciro Santilli taken in 2013 right eye">Ciro Santilli</a>
<a href="https://ourbigbook.com/cirosantilli"><img src="https://raw.githubusercontent.com/cirosantilli/media/master/ourbigbook-logo-v1.svg" loading="lazy" alt="OurBigBook logo">OurBigBook.com</a>
<a class="font-awesome-container" href="https://stackoverflow.com/users/895245"><i class="fab fa-stack-overflow fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://github.com/cirosantilli"><i class="fab fa-github fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://www.linkedin.com/in/cirosantilli"><i class="fab fa-linkedin fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://www.youtube.com/c/CiroSantilli"><i class="fab fa-youtube fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://twitter.com/cirosantilli"><i class="fab fa-twitter fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://www.zhihu.com/people/cirosantilli/activities"><i class="fab fa-zhihu fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://www.weibo.com/p/1005055601627311"><i class="fab fa-weibo fa-fw icon"></i></a>
<a href="sponsor"><span class="icon">$£</span>&nbsp;Sponsor</a>
<a href="https://github.com/cirosantilli/china-dictatorship"><span class="icon">中国</span>独裁统治&nbsp;China Dictatorship 新疆改造中心、六四事件、法轮功、郝海东、709大抓捕、2015巴拿马文件 邓家贵、低端人口、西藏骚乱</a>
</div>
</header>
<main class="ourbigbook">
<div class="h top" id="react"><div class="notnav"><h1><a href="react-split">React</a></h1></div><nav class="h-nav h-nav-toplevel"><div class="nav ancestors"><a  href="#_ancestors">&nbsp;...</a><a href="computer"> Computer</a><a href="software"> Software</a><a href="web-technology"> Web technology</a><a href="web-technology#web-framework"> Web framework</a><a href="web-technology#front-end-web-framework"> Front-end web framework</a><a href="web-technology#list-of-front-end-web-frameworks"> List of front-end web frameworks</a></div><div class="nav"><a href="#_toc" class="toc"></a><a href="https://en.wikipedia.org/wiki/React_(JavaScript library)" class="wiki"></a><a href="https://ourbigbook.com/cirosantilli/react"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a><a class="split" href="react-split"></a><span class="metrics"><span class="wcntr"> Words: 2k</span><span class="dcnt"> Articles: 22</span></span></div></nav></div><div class="p" id="_1">Website: <a href="https://reactjs.org">reactjs.org</a></div><div class="p" id="_2">React officially recommends that you use <a href="#next-js">Next.js</a><a href="https://reactjs.org/docs/create-a-new-react-app.html#recommended-toolchains"><sup class="ref">[ref]</sup></a>, so just do it. It just sets up obvious missing functionality from raw React.</div><div class="p" id="_3">React feels like a good. But it also feels impossible to use/learn sometimes.</div><div class="p" id="_4">Its main design goal is to reduce DOM changes to improve rendering times.</div><div class="p" id="_5">And an important side effect of that is that it becomes easier to do stuff of the type:<div class="list"><ul id="_6"><li id="_7">user creates a new comment that appears on screen without page reload</li><li id="_8">comment has a delete button, which is JavaScript callback activated</li></ul></div>and then the new comment easily gets the callback attached to it.</div><div class="p" id="_9">And it also ends up naturally doubling as a template engine.</div><div class="p" id="_10">But React can also be extremely hard to use. It can be very hard to know what you can and cannot do sometimes, then you have to stop and try to understand how react works things better:<div class="list"><ul id="_11"><li id="_12"><a href="#cannot-update-a-component-while-rendering-a-different-component-warning-in-react">cannot update a component while rendering a different component warning in React</a></li><li id="_13">Rendered more hooks than during the previous render.</li><li id="_14">cannot use hooks from helpers:<div class="list"><ul id="_15"><li id="_16"><a href="https://www.benmvp.com/blog/helper-functions-react-useeffect-hook/">www.benmvp.com/blog/helper-functions-react-useeffect-hook/</a></li><li id="_17"><a href="https://stackoverflow.com/questions/68273638/using-hooks-inside-helper-functions">stackoverflow.com/questions/68273638/using-hooks-inside-helper-functions</a></li><li id="_18"><a href="https://stackoverflow.com/questions/64689409/helper-function-using-hooks-inside-a-functional-component">stackoverflow.com/questions/64689409/helper-function-using-hooks-inside-a-functional-component</a></li></ul></div></li></ul></div>The biggest problem is that it is hard to automatically detect such errors, but perhaps this is the same for other frontend stuff. Though when doing <a href="web-technology#server-side-rendering">server-side rendering</a>, the setup should really tell you about such errors, so you don't just discover them in production later on.</div><div class="p" id="_19">Is is also very difficult to understand precisely why hooks run a certain number of times.</div><div class="p" id="_20">Examples under: <a href="_dir/react">react</a>.<div class="list"><ul id="_21"><li id="_22"><a href="#_file/react/hello.html">react/hello.html</a></li><li id="_23"><a href="_raw/react/hello-func.html">react/hello-func.html</a>: Hello World with a <a href="#react-function-component">React function component</a> instead of classes. At page load console shows:<div class="code" id="_24"><div><pre><code>Main</code></pre></div></div>and then after each click:<div class="code" id="_25"><div><pre><code>onClick
Main</code></pre></div></div>so we understand that <code>Main</code> insanely functions both as the constructor and as the render function in <a href="#react-function-component">React function components</a>.</li><li id="_26"><a href="_raw/react/hello-func-use-callback.html">react/hello-func-use-callback.html</a>: same as <a href="_raw/react/hello-func.html">react/hello-func.html</a> but with useCallback. TODO no advantages in this case? When does it help?</li><li id="_27"><a href="_raw/react/hello-without-jsx.html">react/hello-without-jsx.html</a>: Hello World in pure <a href="programming-language#javascript">JavaScript</a>, without <a href="#react-jsx">JSX</a>. Exactly equivalent to <a href="_raw/react/hello.html">react/hello.html</a>. Documented at: <a href="https://reactjs.org/docs/react-without-jsx.html">reactjs.org/docs/react-without-jsx.html</a> Understanding this is fundamental to understanding React.</li><li id="_28"><div class="p" id="_29"><a href="_raw/react/prop-change.html">react/prop-change.html</a>: shows what gets called as parameters flow down through the tree.</div><div class="p" id="_30">By looking at the console, we see all <code>render</code> get called every time, even if <code>props</code> didn't change, but not the constructors.</div><div class="p" id="_31">After page load the console contains:<div class="code" id="_32"><div><pre><code>Main.constructor
Main.render
NotMain.constructor
NotMain.render
NotMain2.constructor
NotMain2.render</code></pre></div></div></div><div class="p" id="_33">Then, every time we click the button it adds:<div class="code" id="_34"><div><pre><code>handleClick
Main.render
NotMain.render
NotMain2.render</code></pre></div></div></div><div class="p" id="_35">Note how the <code>props</code> of <code>NotMain</code> only change every other click, but <code>render</code> still gets called every time.</div><div class="p" id="_36">In order to make <code>React</code> not re-render when there are not changes, you have to either:<div class="list"><ul id="_37"><li id="_38">define the <code>shouldComponentUpdate</code> method of class components</li><li id="_39">wrap functional components in <code>React.memo</code></li></ul></div></div><div class="p" id="_40">Related:<div class="list"><ul id="_41"><li id="_42"><a href="https://stackoverflow.com/questions/61301937/why-is-react-component-rerendering-when-props-has-not-changed">stackoverflow.com/questions/61301937/why-is-react-component-rerendering-when-props-has-not-changed</a></li><li id="_43"><a href="https://stackoverflow.com/questions/67214500/why-react-rerendres-components-even-if-props-didnt-changed">stackoverflow.com/questions/67214500/why-react-rerendres-components-even-if-props-didnt-changed</a></li></ul></div></div></li><li id="_44"><a href="_raw/react/prop-change-hook.html">react/prop-change-hook.html</a>: same as <a href="_raw/react/prop-change.html">react/prop-change.html</a>, but using hooks. The notable difference is that functional components don't have a clear constructor/render separation, the function just gets called every time. Then React does some magic to ensure that <code>useState</code> returns the current state, except for the first render where they return the initial value.</li><li id="_45"><a href="_raw/react/prop-change-hook-use-memo.html">react/prop-change-hook-use-memo.html</a>: TODO forgot if this example is useful, was tring to use <code>useMemo</code></li><li id="_46"><a href="_raw/react/prop-change-child.html">react/prop-change-child.html</a>: shows what child prop changes do not call render on parent, <code>Main</code> does not show up on console when you click under <code>NotMain</code></li><li id="_47"><a href="_raw/react/hook-from-function-fail.html">react/hook-from-function-fail.html</a>: TODO got some errors that seemed linked to this on a larger program, but failed to minimize them here</li><li id="_48"><a href="_raw/react/hook-different-number-of-times.html">react/hook-different-number-of-times.html</a>: this illustrates one of the cardinal points of using hooks: you must always call them the same number of times, otherwise it fails with:<div><blockquote id="_49">React has detected a change in the order of Hooks called by Main. This will lead to bugs and errors if not fixed.</blockquote></div>In the case of <code>useState</code>, we can kind of understand why this happens: React must use the order of calls to determine which state variable to return at each point in time.</li><li id="_50"><a href="_raw/react/hello-hook-use-effect.html">react/hello-hook-use-effect.html</a>: just checking when it gets called. Happens after every render<div class="code" id="_51"><div><pre><code>handleClick
Main
useEffect
useEffect2</code></pre></div></div></li><li id="_52">TODO create a test <code>\a[react/img-broken.html]</code><div class="list"><ul id="_53"><li id="_54"><a href="https://stackoverflow.com/questions/34097560/react-js-replace-img-src-onerror">stackoverflow.com/questions/34097560/react-js-replace-img-src-onerror</a></li><li id="_55"><a href="https://stackoverflow.com/questions/36305805/how-to-hide-alt-text-using-css-when-the-image-is-not-present">stackoverflow.com/questions/36305805/how-to-hide-alt-text-using-css-when-the-image-is-not-present</a></li></ul></div></li></ul></div></div><div class="p" id="_56">How React works bibliography:<div class="list"><ul id="_57"><li id="_58"><a href="https://www.netlify.com/blog/2019/03/11/deep-dive-how-do-react-hooks-really-work/">www.netlify.com/blog/2019/03/11/deep-dive-how-do-react-hooks-really-work/</a> shows how <code>uesState</code> works under the hood with crazy closures</li><li id="_59"><a href="https://medium.com/@gethylgeorge/how-virtual-dom-and-diffing-works-in-react-6fc805f9f84e">medium.com/@gethylgeorge/how-virtual-dom-and-diffing-works-in-react-6fc805f9f84e</a></li></ul></div></div><div class="figure"><figure id="video-react-for-the-haters-in-100-seconds-by-fireship-2022"><div class="float-wrap"><iframe width="560" height="315" loading="lazy" src="https://www.youtube.com/embed/HyWYpM_S-2c" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div><figcaption><a href="#video-react-for-the-haters-in-100-seconds-by-fireship-2022"><span class="caption-prefix">Video 1. </span></a><div class="title">React for the Haters in 100 Seconds by Fireship (2022)</div> <a href="https://www.youtube.com/watch?v=HyWYpM_S-2c">Source</a>. </figcaption></figure></div><div class="toc-container" id="_toc"><ul><li class="has-child toplevel"><div class="title-div"><div class="arrow"><div></div></div><span class="not-arrow"><a class="title toc" href="#_toc"> Table of contents</a><input class="search" placeholder="🔍 Search. Shortcut: / (slash)"><span class="hover-metadata"><span class="metrics"><span class="wcntr"> 2k</span><span class="dcnt"> 22</span></span></span></span></div><ul><li><div id="_toc/react-jsx"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#react-jsx">React JSX</a><span class="hover-metadata"><a href="#_toc" class="u"> React</a></span></span></div></li><li class="has-child"><div id="_toc/react-error"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#react-error">React error</a><span class="hover-metadata"><a href="#_toc" class="u"> React</a><span class="metrics"><span class="wcntr"> 2</span><span class="dcnt"> 1</span></span></span></span></div><ul><li><div id="_toc/cannot-update-a-component-while-rendering-a-different-component-warning-in-react"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#cannot-update-a-component-while-rendering-a-different-component-warning-in-react">Cannot update a component while rendering a different component warning in React</a><span class="hover-metadata"><a href="#_toc/react-error" class="u"> React error</a><span class="metrics"><span class="wcntr"> 2</span></span></span></span></div></li></ul><li class="has-child"><div id="_toc/react-example"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#react-example">React example</a><span class="hover-metadata"><a href="#_toc" class="u"> React</a><span class="metrics"><span class="wcntr"> 100</span><span class="dcnt"> 2</span></span></span></span></div><ul><li><div id="_toc/_file/react/hello.html"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#_file/react/hello.html">react/hello.html</a><span class="hover-metadata"><a href="#_toc/react-example" class="u"> React example</a><span class="metrics"><span class="wcntr"> 93</span></span></span></span></div></li><li><div id="_toc/_file/react/ref-twice.html"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#_file/react/ref-twice.html">react/ref-twice.html</a><span class="hover-metadata"><a href="#_toc/react-example" class="u"> React example</a><span class="metrics"><span class="wcntr"> 7</span></span></span></span></div></li></ul><li class="has-child"><div id="_toc/react-dom-manipulation"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#react-dom-manipulation">React DOM manipulation</a><span class="hover-metadata"><a href="#_toc" class="u"> React</a><span class="metrics"><span class="wcntr"> 108</span><span class="dcnt"> 2</span></span></span></span></div><ul><li><div id="_toc/_file/react/ref-click-counter.html"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#_file/react/ref-click-counter.html">react/ref-click-counter.html</a><span class="hover-metadata"><a href="#_toc/react-dom-manipulation" class="u"> React DOM manipulation</a><span class="metrics"><span class="wcntr"> 104</span></span></span></span></div></li><li><div id="_toc/_file/react/ref-click-counter-func.html"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#_file/react/ref-click-counter-func.html">react/ref-click-counter-func.html</a><span class="hover-metadata"><a href="#_toc/react-dom-manipulation" class="u"> React DOM manipulation</a><span class="metrics"><span class="wcntr"> 4</span></span></span></span></div></li></ul><li class="has-child"><div id="_toc/react-class-vs-function-component"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#react-class-vs-function-component">React class vs function component</a><span class="hover-metadata"><a href="#_toc" class="u"> React</a><span class="metrics"><span class="wcntr"> 59</span><span class="dcnt"> 6</span></span></span></span></div><ul><li><div id="_toc/react-class-component"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#react-class-component">React class component</a><span class="hover-metadata"><a href="#_toc/react-class-vs-function-component" class="u"> React class vs function component</a></span></span></div></li><li class="has-child"><div id="_toc/react-function-component"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#react-function-component">React function component</a><span class="hover-metadata"><a href="#_toc/react-class-vs-function-component" class="u"> React class vs function component</a><span class="metrics"><span class="wcntr"> 20</span><span class="dcnt"> 4</span></span></span></span></div><ul><li class="has-child"><div id="_toc/react-hook"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#react-hook">React hook</a><span class="hover-metadata"><a href="#_toc/react-function-component" class="u"> React function component</a><span class="metrics"><span class="wcntr"> 20</span><span class="dcnt"> 3</span></span></span></span></div><ul><li><div id="_toc/useeffect"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#useeffect"><code>useEffect</code></a><span class="hover-metadata"><a href="#_toc/react-hook" class="u"> React hook</a><span class="metrics"><span class="wcntr"> 20</span></span></span></span></div></li><li><div id="_toc/useref"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#useref"><code>useRef</code></a><span class="hover-metadata"><a href="#_toc/react-hook" class="u"> React hook</a></span></span></div></li><li><div id="_toc/usecallback"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#usecallback"><code>useCallback</code></a><span class="hover-metadata"><a href="#_toc/react-hook" class="u"> React hook</a></span></span></div></li></ul></li></ul></li></ul><li class="has-child"><div id="_toc/next-js"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#next-js">Next.js</a><span class="hover-metadata"><a href="#_toc" class="u"> React</a><span class="metrics"><span class="wcntr"> 867</span><span class="dcnt"> 5</span></span></span></span></div><ul><li class="has-child"><div id="_toc/next-js-example"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#next-js-example">Next.js example</a><span class="hover-metadata"><a href="#_toc/next-js" class="u"> Next.js</a><span class="metrics"><span class="wcntr"> 379</span><span class="dcnt"> 3</span></span></span></span></div><ul><li><div id="_toc/_file/nodejs/next/posts"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#_file/nodejs/next/posts">nodejs/next/posts</a><span class="hover-metadata"><a href="#_toc/next-js-example" class="u"> Next.js example</a><span class="metrics"><span class="wcntr"> 131</span></span></span></span></div></li><li><div id="_toc/_file/nodejs/next/ref-twice"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#_file/nodejs/next/ref-twice">nodejs/next/ref-twice</a><span class="hover-metadata"><a href="#_toc/next-js-example" class="u"> Next.js example</a><span class="metrics"><span class="wcntr"> 126</span></span></span></span></div></li><li><div id="_toc/_file/nodejs/next/inject-into-static"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#_file/nodejs/next/inject-into-static">nodejs/next/inject-into-static</a><span class="hover-metadata"><a href="#_toc/next-js-example" class="u"> Next.js example</a><span class="metrics"><span class="wcntr"> 24</span></span></span></span></div></li></ul><li><div id="_toc/node-express-sequelize-next-js-realworld-example-app"><div class="arrow"><div></div></div><span class="not-arrow"><a href="#node-express-sequelize-next-js-realworld-example-app">Node Express Sequelize Next.js realworld example app</a><span class="hover-metadata"><a href="#_toc/next-js" class="u"> Next.js</a></span></span></div></li></ul></li></ul></li></ul></div><div class="h" id="react-jsx"><div class="notnav"><h2><a href="react-jsx">React JSX <span class="meta">(JSX)</span></a></h2><span class="hover-meta"> <a class="split" href="react-jsx"></a></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="" class="u"> React</a><a href="#_toc/react-jsx" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/react-jsx"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="h" id="react-error"><div class="notnav"><h2><a href="react-error">React error</a></h2><span class="hover-meta"> <a class="split" href="react-error"></a><span class="metrics"><span class="wcntr"> Words: 2</span><span class="dcnt"> Articles: 1</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="" class="u"> React</a><a href="#_toc/react-error" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/react-error"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="h" id="cannot-update-a-component-while-rendering-a-different-component-warning-in-react"><div class="notnav"><h3><a href="cannot-update-a-component-while-rendering-a-different-component-warning-in-react">Cannot update a component while rendering a different component warning in React</a></h3><span class="hover-meta"> <a class="split" href="cannot-update-a-component-while-rendering-a-different-component-warning-in-react"></a><span class="metrics"><span class="wcntr"> Words: 2</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-error" class="u"> React error</a><a href="#_toc/cannot-update-a-component-while-rendering-a-different-component-warning-in-react" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/cannot-update-a-component-while-rendering-a-different-component-warning-in-react"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="p" id="_61">Minimal reproduction: <a href="https://stackoverflow.com/questions/62336340/cannot-update-a-component-while-rendering-a-different-component-warning/70317831#70317831">stackoverflow.com/questions/62336340/cannot-update-a-component-while-rendering-a-different-component-warning/70317831#70317831</a></div><div class="h" id="react-example"><div class="notnav"><h2><a href="react-example">React example</a></h2><span class="hover-meta"> <a class="split" href="react-example"></a><span class="metrics"><span class="wcntr"> Words: 100</span><span class="dcnt"> Articles: 2</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="" class="u"> React</a><a href="#_toc/react-example" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/react-example"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="h" id="_file/react/hello.html"><div class="notnav"><span class="file" title="This article is about a file." /><h3><a href="_file/react/hello.html">react/hello.html</a></h3><span class="hover-meta"> <a class="split" href="_file/react/hello.html"></a><span class="metrics"><span class="wcntr"> Words: 93</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-example" class="u"> React example</a><a href="#_toc/_file/react/hello.html" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/_file/react/hello.html"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div><div class="nav file"><b> <a href="_dir">(root)</a> / <a href="_dir/react">react</a> / <a href="_raw/react/hello.html">hello.html</a></b></div></nav></div><div class="p" id="_62">Minimal React hello world example. As you click:<div class="list"><ul id="_63"><li id="_64">one counter increments every time</li><li id="_65">the other increments every two clicks</li></ul></div>By opening a web inspector, you can see that only modified elements get updated. So we understand that <a href="#react-jsx">JSX</a> parses its "HTML-like" into a tree, and then propagates updates on that tree.</div><div class="p" id="_66">By looking at the terminal, we see that <code>render()</code> does get called every time the button is clicked, so the tree of elements does get recreated every time. But then React diffes thing out and only updates things in the DOM where needed.</div><div class="p"><b>react/hello.html</b></div><div class="code"><div><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset="utf-8" /&gt;
&lt;script src="https://unpkg.com/react@18.3.1/umd/react.development.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/react-dom@18.3.1/umd/react-dom.development.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/@babel/standalone@7.14.7/babel.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;&lt;a href="https://cirosantilli.com/_file/react/hello.htmlhttps://cirosantilli.com/react"&gt;https://cirosantilli.com/_file/react/hello.html&lt;/a&gt;&lt;/p&gt;
&lt;div id="root"&gt;&lt;/div&gt;
&lt;script type="text/babel"&gt;
class Main extends React.Component {
  constructor(props) {
    super(props)
    console.log('Main.constructor')
    this.state = {n: 0}
  }

  render() {
    console.log('Main.render')
    return (
      &lt;div&gt;
        &lt;button
          onClick={
            () =&gt; {
              console.log('onClick')
              this.setState((state, props) =&gt; ({
                n: state.n + 1
              }))
            }
          }&gt;Click me&lt;/button&gt;
        &lt;div&gt;n = {this.state.n}&lt;/div&gt;
        &lt;div&gt;n/2 = {Math.floor(this.state.n / 2)}&lt;/div&gt;
      &lt;/div&gt;
    )
  }
}
ReactDOM.createRoot(document.getElementById('root')).render(&lt;React.StrictMode&gt;&lt;Main /&gt;&lt;/React.StrictMode&gt;)
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div><div class="h" id="_file/react/ref-twice.html"><div class="notnav"><span class="file" title="This article is about a file." /><h3><a href="_file/react/ref-twice.html">react/ref-twice.html</a></h3><span class="hover-meta"> <a class="split" href="_file/react/ref-twice.html"></a><span class="metrics"><span class="wcntr"> Words: 7</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-example" class="u"> React example</a><a href="#_toc/_file/react/ref-twice.html" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/_file/react/ref-twice.html"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div><div class="nav file"><b> <a href="_dir">(root)</a> / <a href="_dir/react">react</a> / <a href="_raw/react/ref-twice.html">ref-twice.html</a></b></div></nav></div><div class="p" id="_67">Failed attempt at minimizing <a href="#_file/nodejs/next/ref-twice">nodejs/next/ref-twice</a> outside of <a href="#next-js">Next.js</a>.</div><div class="p"><b>react/ref-twice.html</b></div><div class="code"><div><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset="utf-8" /&gt;
&lt;script src="https://unpkg.com/react@18.3.1/umd/react.development.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/react-dom@18.3.1/umd/react-dom.development.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/@babel/standalone@7.14.7/babel.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;&lt;a href="https://cirosantilli.com/_file/react/ref-twice.html"&gt;https://cirosantilli.com/_file/react/ref-twice.html&lt;/a&gt;&lt;/p&gt;
&lt;div id="root"&gt;&lt;/div&gt;
&lt;script type="text/babel"&gt;
const { StrictMode, useState, useEffect, useRef } = React

function complexExternalLibraryFunctionWithoutCleanup(elem, cb) {
  elem.addEventListener('click', () =&gt; {
    cb()
  })
}

function Main(props) {
  const [text, setText] = useState('')
  const [myint, setMyint] = useState(0)
  const ref = useRef(null)
  function incIt() {
    setMyint(i =&gt; i+1)
  }
  useEffect(() =&gt; {
    if (ref.current) {
      complexExternalLibraryFunctionWithoutCleanup(ref.current, incIt)
    }
  }, [])
  return &lt;div&gt;
    &lt;div&gt;&lt;input value={text} onChange={e =&gt; setText(e.target.value)} placeholder='Type here' /&gt;&lt;/div&gt;
    &lt;div&gt;You typed: {text}&lt;/div&gt;
    &lt;div&gt;&lt;button ref={ref}&gt;Click me after typing something! If unfixed, it will increment twice!&lt;/button&gt;&lt;/div&gt;
    &lt;div&gt;&lt;button onClick={incIt}&gt;Click me to increment!&lt;/button&gt;&lt;/div&gt;
    &lt;div&gt;{myint}&lt;/div&gt;
  &lt;/div&gt;
}
ReactDOM.createRoot(document.getElementById('root')).render(&lt;StrictMode&gt;&lt;Main /&gt;&lt;/StrictMode&gt;)
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div><div class="h" id="react-dom-manipulation"><div class="notnav"><h2><a href="react-dom-manipulation">React DOM manipulation</a></h2><span class="hover-meta"> <a class="split" href="react-dom-manipulation"></a><span class="metrics"><span class="wcntr"> Words: 108</span><span class="dcnt"> Articles: 2</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="" class="u"> React</a><a href="#_toc/react-dom-manipulation" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/react-dom-manipulation"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="h" id="_file/react/ref-click-counter.html"><div class="notnav"><span class="file" title="This article is about a file." /><h3><a href="_file/react/ref-click-counter.html">react/ref-click-counter.html</a></h3><span class="hover-meta"> <a class="split" href="_file/react/ref-click-counter.html"></a><span class="metrics"><span class="wcntr"> Words: 104</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-dom-manipulation" class="u"> React DOM manipulation</a><a href="#_toc/_file/react/ref-click-counter.html" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/_file/react/ref-click-counter.html"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div><div class="nav file"><b> <a href="_dir">(root)</a> / <a href="_dir/react">react</a> / <a href="_raw/react/ref-click-counter.html">ref-click-counter.html</a></b></div></nav></div><div class="p" id="_68">Dummy example of using a <a href="#react-dom-manipulation">React <code>ref</code></a> This example is useless and to the end user seems functionally equivalent to <a href="#_file/react/hello.html">react/hello.html</a>.</div><div class="p" id="_69">It does however serve as a good example of what react does that is useful: it provides a "clear" separation between state and render code (which becomes once again much less clear in <a href="#react-function-component">React function components</a>.</div><div class="p" id="_70">Notably, this example is insane because at:<div class="code" id="_71"><div><pre><code>&lt;button onClick={() =&gt; {
  elem.innerHTML = (parseInt(elem.innerHTML) + 1).toString()</code></pre></div></div>we are extracing state from some random HTML string rather than having a clean <a href="programming-language#javascript">JavaScript</a> variable containing that value.</div><div class="p" id="_72">In this case we managed to get away with it, but this is in general not easy/possible.</div><div class="p"><b>react/ref-click-counter.html</b></div><div class="code"><div><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset="utf-8" /&gt;
&lt;title&gt;ref click counter&lt;/title&gt;
&lt;script src="https://unpkg.com/react@17/umd/react.development.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/@babel/standalone@7.14.7/babel.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="root"&gt;&lt;/div&gt;
&lt;script type="text/babel"&gt;
class Main extends React.Component {
  constructor(props) {
    super(props)
    console.log('Main.constructor')
    this.counterElem = null
  }

  render() {
    console.log('render')
    return (
      &lt;div&gt;
        &lt;button onClick={() =&gt; {
          console.log('onClick')
          elem = this.counterElem
          elem.innerHTML = (parseInt(elem.innerHTML) + 1).toString()
        }}&gt;
          Click me
        &lt;/button&gt;
        &lt;div
          ref={
            (elem) =&gt; {
              console.log(`ref callback ${elem}`)
              this.counterElem = elem
            }
          }
        &gt;
          0
        &lt;/div&gt;
      &lt;/div&gt;
    )
  }
}

ReactDOM.render(
  &lt;Main/&gt;,
  document.getElementById('root')
)
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div><div class="h" id="_file/react/ref-click-counter-func.html"><div class="notnav"><span class="file" title="This article is about a file." /><h3><a href="_file/react/ref-click-counter-func.html">react/ref-click-counter-func.html</a></h3><span class="hover-meta"> <a class="split" href="_file/react/ref-click-counter-func.html"></a><span class="metrics"><span class="wcntr"> Words: 4</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-dom-manipulation" class="u"> React DOM manipulation</a><a href="#_toc/_file/react/ref-click-counter-func.html" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/_file/react/ref-click-counter-func.html"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div><div class="nav file"><b> <a href="_dir">(root)</a> / <a href="_dir/react">react</a> / <a href="_raw/react/ref-click-counter-func.html">ref-click-counter-func.html</a></b></div></nav></div><div class="p" id="_73"><a href="#react-function-component">React function component</a> version of <a href="#_file/react/ref-click-counter.html">react/ref-click-counter.html</a> using <a href="#useref"><code>useRef</code></a>.</div><div class="p"><b>react/ref-click-counter-func.html</b></div><div class="code"><div><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset="utf-8" /&gt;
&lt;title&gt;ref click counter&lt;/title&gt;
&lt;script src="https://unpkg.com/react@17/umd/react.development.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/@babel/standalone@7.14.7/babel.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="root"&gt;&lt;/div&gt;
&lt;script type="text/babel"&gt;
function Main() {
  console.log('Main')
  const counterElem = React.useRef(null)
  return (
    &lt;div&gt;
      &lt;button onClick={() =&gt; {
        console.log('onClick')
        const elem = counterElem.current
        elem.innerHTML = (parseInt(elem.innerHTML) + 1).toString()
      }}&gt;
        Click me
      &lt;/button&gt;
      &lt;div
        ref={
          (elem) =&gt; {
            counterElem.current = elem
          }
        }
      &gt;
        0
      &lt;/div&gt;
    &lt;/div&gt;
  )
}
ReactDOM.render( &lt;Main/&gt;, document.getElementById('root'))
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div><div class="h" id="react-class-vs-function-component"><div class="notnav"><h2><a href="react-class-vs-function-component">React class vs function component</a></h2><span class="hover-meta"> <a class="split" href="react-class-vs-function-component"></a><span class="metrics"><span class="wcntr"> Words: 59</span><span class="dcnt"> Articles: 6</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="" class="u"> React</a><a href="#_toc/react-class-vs-function-component" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/react-class-vs-function-component"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="p" id="_74"><a href="#react-function-component">React function components</a> do produce shorter code. But they are also impossible to understand without knowing what is their corresponding class component.</div><div class="p" id="_75">Hooks were introduced much after classes, and just require less code, so everyone is using them now instead of classes.</div><div class="h" id="react-class-component"><div class="notnav"><h3><a href="react-class-component">React class component</a></h3><span class="hover-meta"> <a class="split" href="react-class-component"></a></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-class-vs-function-component" class="u"> React class vs function component</a><a href="#_toc/react-class-component" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/react-class-component"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="h" id="react-function-component"><div class="notnav"><h3><a href="react-function-component">React function component</a></h3><span class="hover-meta"> <a class="split" href="react-function-component"></a><span class="metrics"><span class="wcntr"> Words: 20</span><span class="dcnt"> Articles: 4</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-class-vs-function-component" class="u"> React class vs function component</a><a href="#_toc/react-function-component" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/react-function-component"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="h" id="react-hook"><div class="notnav"><h4><a href="react-hook">React hook</a></h4><span class="hover-meta"> <a class="split" href="react-hook"></a><span class="metrics"><span class="wcntr"> Words: 20</span><span class="dcnt"> Articles: 3</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-function-component" class="u"> React function component</a><a href="#_toc/react-hook" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/react-hook"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="h" id="useeffect"><div class="notnav"><h5><a href="useeffect"><code>useEffect</code></a></h5><span class="hover-meta"> <a class="split" href="useeffect"></a><span class="metrics"><span class="wcntr"> Words: 20</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-hook" class="u"> React hook</a><a href="#_toc/useeffect" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/useeffect"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="p" id="_76">This should only be used for things that happen outside of the state that <a href="">React</a> trackes, e.g. <code>window</code> event handlers.</div><div class="p" id="_77">Examples:<div class="list"><ul id="_78"><li id="_79"><a href="#_file/react/ref-click-counter-func.html">react/ref-click-counter-func.html</a></li></ul></div></div><div class="h" id="useref"><div class="notnav"><h5><a href="useref"><code>useRef</code></a></h5><span class="hover-meta"> <a class="split" href="useref"></a></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-hook" class="u"> React hook</a><a href="#_toc/useref" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/useref"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="h" id="usecallback"><div class="notnav"><h5><a href="usecallback"><code>useCallback</code></a></h5><span class="hover-meta"> <a class="split" href="usecallback"></a></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#react-hook" class="u"> React hook</a><a href="#_toc/usecallback" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/usecallback"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="h" id="next-js"><div class="notnav"><h2><a href="next-js">Next.js</a></h2><span class="hover-meta"> <a class="split" href="next-js"></a><span class="metrics"><span class="wcntr"> Words: 867</span><span class="dcnt"> Articles: 5</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="" class="u"> React</a><a href="#_toc/next-js" class="toc"></a><a href="https://en.wikipedia.org/wiki/Next.js" class="wiki"></a><a href="https://ourbigbook.com/cirosantilli/next-js"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="p" id="_80">Framework built on top of <a href="">React</a>.</div><div class="p" id="_81">Officially recommended by <a href="">React</a><a href="https://reactjs.org/docs/create-a-new-react-app.html"><sup class="ref">[ref]</sup></a>:<div><blockquote id="_82"><div class="p" id="_83">Recommended Toolchains</div><div class="p" id="_84">If you’re building a server-rendered website with Node.js, try Next.js.</div></blockquote></div></div><div class="p" id="_85"><a href="web-technology#gothinkster-realworld">gothinkster/realworld</a> blog example by <a href="ciro-santilli">Ciro Santilli</a>: <a href="#node-express-sequelize-next-js-realworld-example-app">node Express Sequelize Next.js realworld example app</a>.</div><div class="p" id="_86">Basically what this does is to get <a href="web-technology#server-side-rendering">server-side rendering</a> just working by <a href="">React</a>, including hydration, which is a good thing.</div><div class="p" id="_87">Next.js sends the first pre-rendered HTML page along with the JavaScript code. Then, JavaScript page switches just load the API data.</div><div class="p" id="_88">Next.js does this nicely by forcing you to provide page data in a serialized JSON format, even when rendering server-side (e.g. the return value of <code>getServerSideProps</code>). This way, it is also able to provide either the full HTML, or just the JSON.</div><div class="p" id="_89">Some general downsides:<div class="list"><ul id="_90"><li id="_91">it does feel like they don't document deployment very well however, especially non-Vercel options, which is the company behind Next.js. I'm unable to find how to use a non Vercel CDN with ISR supposing that is possible.</li><li id="_92">Next.js is very opinionated, and like any opinionated library it is sometimes hard to know why something is/isn't happening, and sometimes it is hard/impossible to do what you want with it unless they add support. They have done good progress, but even as of 2022, some aspects just feel so immature, some major-looking use cases are not very well done.</li></ul></div></div><div class="p" id="_93">In theory, Next.js could be the "ultimate frontend framework". It does have a lot of development difficulties that need to be ironed out, but the general concepts, and things it tries to integrate, including e.g. <a href="webpack">webpack</a>, <a href="typescript">TypeScript</a>, etc. are good. Maybe the question is when will someone put it together with an amazing backend library and dominate and finally put an end to the infinite number of Js Frameworks!</div><div class="p" id="_94">In-tree examples at: <a href="https://github.com/vercel/next.js/tree/canary/examples">github.com/vercel/next.js/tree/canary/examples</a></div><div class="p" id="_95"><code>canary</code> is their <code>master</code>: <a href="https://github.com/vercel/next.js/issues/3211">github.com/vercel/next.js/issues/3211</a></div><div class="p" id="_96">In order to offer its amazing features, Next.js is also extremely opinionated, which means that if something wasn't designed to be possible, it basically isn't.</div><div class="p" id="_97">No prerender with custom <a href="computer#server-computing">server</a>? It forces you to write your API with next as well? Or does it mean something else?<div class="list"><ul id="_98"><li id="_99"><a href="https://github.com/vercel/next.js/discussions/25394">github.com/vercel/next.js/discussions/25394</a></li><li id="_100"><a href="https://nextjs.org/docs/advanced-features/custom-server">nextjs.org/docs/advanced-features/custom-server</a></li></ul></div></div><div class="p" id="_101">TODO can it statically generate pages that are created at runtime? E.g. if I create a new blog post, will it automatically upload a static page? It seems that yes, and that this is exactly what Incremental Static Regeneration means:<div class="list"><ul id="_102"><li id="_103"><a href="https://github.com/vercel/next.js/discussions/25410">github.com/vercel/next.js/discussions/25410</a></li><li id="_104"><a href="https://vercel.com/docs/next.js/incremental-static-regeneration">vercel.com/docs/next.js/incremental-static-regeneration</a></li><li id="_105"><a href="https://github.com/vercel/next.js/discussions/17711">github.com/vercel/next.js/discussions/17711</a></li><li id="_106"><a href="https://www.reddit.com/r/nextjs/comments/mvvhym/a_complete_guide_to_incremental_static/">www.reddit.com/r/nextjs/comments/mvvhym/a_complete_guide_to_incremental_static/</a></li><li id="_107"><a href="https://github.com/vercel/next.js/discussions/11552#discussioncomment-115595">github.com/vercel/next.js/discussions/11552#discussioncomment-115595</a></li><li id="_108"><a href="https://stackoverflow.com/questions/62105756/how-to-use-aws-with-next-js">stackoverflow.com/questions/62105756/how-to-use-aws-with-next-js</a></li><li id="_109"><a href="https://github.com/vercel/next.js/discussions/17080">github.com/vercel/next.js/discussions/17080</a></li><li id="_110"><a href="https://github.com/vercel/next.js/discussions/16852">github.com/vercel/next.js/discussions/16852</a></li></ul></div>However, Ciro can't find any mention of how to specify where the pages are uploaded to... this is pat of the non-Vercel deployment problem.</div><div class="p" id="_111">Can't ISR prerenter by URL query parameters:<div class="list"><ul id="_112"><li id="_113"><a href="https://stackoverflow.com/questions/66133814/how-to-get-url-query-string-on-next-js-static-site-generation">stackoverflow.com/questions/66133814/how-to-get-url-query-string-on-next-js-static-site-generation</a></li><li id="_114"><a href="https://github.com/vercel/next.js/discussions/17269">github.com/vercel/next.js/discussions/17269</a></li></ul></div>That plus the requirement to have one page per file under <code>pages/</code> leads to a lot of useless duplication, because then you are forced to place the URL parameters on the pathnames.</div><div class="p" id="_115">"Module not found: Can't resolve 'fs'" <a href="religion#hell">Hell</a>. The main reason this happens seems to be the that in a higher order component, <a href="webpack">webpack</a> can't determine if callbacks use the require or not to remove it from frontend code. Fully investigated and solved at:<div class="list"><ul id="_116"><li id="_117"><a href="https://stackoverflow.com/questions/64926174/module-not-found-cant-resolve-fs-in-next-js-application/70363153#70363153">stackoverflow.com/questions/64926174/module-not-found-cant-resolve-fs-in-next-js-application/70363153#70363153</a></li></ul></div></div><div class="p" id="_118">Overviews:<div class="list"><ul id="_119"><li id="_120"><a href="https://www.reddit.com/r/reactjs/comments/8evy5d/what_are_the_downsides_to_nextjs/">www.reddit.com/r/reactjs/comments/8evy5d/what_are_the_downsides_to_nextjs/</a> 2017 What are the downsides to Next.js?</li></ul></div></div><div class="p" id="_121">TODO answer:<div class="list"><ul id="_122"><li id="_123"><a href="https://stackoverflow.com/questions/59674496/how-to-pass-pageprops-in-next-js-from-a-child-component-to-app-js">stackoverflow.com/questions/59674496/how-to-pass-pageprops-in-next-js-from-a-child-component-to-app-js</a></li></ul></div></div><div class="h" id="next-js-example"><div class="notnav"><h3><a href="next-js-example">Next.js example</a></h3><span class="hover-meta"> <a class="split" href="next-js-example"></a><span class="metrics"><span class="wcntr"> Words: 379</span><span class="dcnt"> Articles: 3</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#next-js" class="u"> Next.js</a><a href="#_toc/next-js-example" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/next-js-example"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div></nav></div><div class="p" id="_124">Our examples are located under <a href="_dir/nodejs/next">nodejs/next</a>:<div class="list"><ul id="_125"><li id="_126"><a href="_dir/nodejs/next/hello-world">nodejs/next/hello-world</a>: a hello world. There's an in-tree one at: <a href="https://github.com/vercel/next.js/tree/e75361fd03872b097e817634c049b3185f24cf56/examples/hello-world">github.com/vercel/next.js/tree/e75361fd03872b097e817634c049b3185f24cf56/examples/hello-world</a>, but ours is truly minimal</li><li id="_127"><a href="_dir/nodejs/next/hoc">nodejs/next/hoc</a>: shows how to use a higher order component (HOC) to factor out <code>getStaticProps</code> across two pages: <a href="_raw/nodejs/next/hoc/pages/index.js">nodejs/next/hoc/pages/index.js</a> and <a href="_raw/nodejs/next/hoc/pages/notindex.js">nodejs/next/hoc/pages/notindex.js</a></li><li id="_128"><div class="p" id="_129"><a href="_dir/nodejs/next/typescript">nodejs/next/typescript</a>: simple <a href="typescript">TypeScript</a> example, minimized from: <a href="https://github.com/vercel/next.js/tree/d61b0761efae09bd9cb1201ff134ed8950d9deca/examples/with-typescript">github.com/vercel/next.js/tree/d61b0761efae09bd9cb1201ff134ed8950d9deca/examples/with-typescript</a></div><div class="p" id="_130">Notably, that shows how <code>require</code> errors are avoided in that case as mentioned at: <a href="https://stackoverflow.com/questions/64926174/module-not-found-cant-resolve-fs-in-next-js-application/70363153#70363153">stackoverflow.com/questions/64926174/module-not-found-cant-resolve-fs-in-next-js-application/70363153#70363153</a></div></li><li id="_131"><a href="_dir/nodejs/next/localStorage">nodejs/next/localStorage</a>: a counter that is persistent across page reloads by using <code>localStorage</code>. Used in: <a href="https://stackoverflow.com/questions/54819721/next-js-access-localstorage-before-rendering-page/68136224#68136224">stackoverflow.com/questions/54819721/next-js-access-localstorage-before-rendering-page/68136224#68136224</a></li></ul></div></div><div class="p" id="_132">Solved ones:<div class="list"><ul id="_133"><li id="_134">solved by <a href="https://nextjs.org/docs/advanced-features/preview-mode">preview mode</a> in Next.js 12:<div class="list"><ul id="_135"><li id="_136">ISR was basically unusable for CRUD websites because you can't force a one-off immediate page update:<div class="list"><ul id="_137"><li id="_138"><a href="https://github.com/vercel/next.js/discussions/25677">github.com/vercel/next.js/discussions/25677</a></li></ul></div></li></ul></div></li></ul></div></div><div class="h" id="_file/nodejs/next/posts"><div class="notnav"><span class="file" title="This article is about a file." /><h4><a href="_file/nodejs/next/posts">nodejs/next/posts</a></h4><span class="hover-meta"> <a class="split" href="_file/nodejs/next/posts"></a><span class="metrics"><span class="wcntr"> Words: 131</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#next-js-example" class="u"> Next.js example</a><a href="#_toc/_file/nodejs/next/posts" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/_file/nodejs/next/posts"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div><div class="nav file"><b> <a href="_dir">(root)</a> / <a href="_dir/nodejs">nodejs</a> / <a href="_dir/nodejs/next">next</a> / <a href="_dir/nodejs/next/posts">posts</a></b></div></nav></div><div class="p" id="_139">The goal of this example is to understand when states and effects happen when changing between different routes that use the same component.</div><div class="p" id="_140">Behavior is follows:<div class="list"><ul id="_141"><li id="_142">visit: <a href="http://localhost:3001/1">localhost:3001/1</a></li><li id="_143">click <code>count++</code>. This makes <code>count: 1</code></li><li id="_144">click "2" to visit <a href="http://localhost:3001/2">localhost:3001/2</a></li><li id="_145">outcome: count is still 1</li></ul></div></div><div class="p" id="_146">This is likely because in <a href="">React</a> the state kept in the virtual DOM structure, and identical structure implies identical state. So when we change from post 1 to 2, we still have a <code>Post</code> object, and state is unchanged.</div><div class="p" id="_147">Next if we click:<div class="list"><ul id="_148"><li id="_149">"Index" to go to <a href="http://localhost:3000">localhost:3000</a></li><li id="_150">"1" to go to <a href="http://localhost:3001/1">localhost:3001/1</a></li></ul></div>then the count is back to 0. This is because we changed the <code>Post</code> object in the DOM to <code>Index</code> and back, which resets everything.</div><div class="p" id="_151">This example also illustrates how to prevent this from happening with <a href="#useeffect"><code>useEffect</code></a>.</div><div class="p" id="_152">Bibliography:<div class="list"><ul id="_153"><li id="_154"><a href="https://stackoverflow.com/questions/63143334/how-to-not-persist-state-between-next-js-dynamic-routes">stackoverflow.com/questions/63143334/how-to-not-persist-state-between-next-js-dynamic-routes</a></li></ul></div></div><div class="h" id="_file/nodejs/next/ref-twice"><div class="notnav"><span class="file" title="This article is about a file." /><h4><a href="_file/nodejs/next/ref-twice">nodejs/next/ref-twice</a></h4><span class="hover-meta"> <a class="split" href="_file/nodejs/next/ref-twice"></a><span class="metrics"><span class="wcntr"> Words: 126</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#next-js-example" class="u"> Next.js example</a><a href="#_toc/_file/nodejs/next/ref-twice" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/_file/nodejs/next/ref-twice"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div><div class="nav file"><b> <a href="_dir">(root)</a> / <a href="_dir/nodejs">nodejs</a> / <a href="_dir/nodejs/next">next</a> / <a href="_dir/nodejs/next/ref-twice">ref-twice</a></b></div></nav></div><div class="p" id="_155">This is a minimal reproducible example for the terrible problem of external effects applying twice to refs for effects that are not idempotent and thus blowup if applied twice.</div><div class="p" id="_156">The issue is currently discussed at: <a href="https://react.dev/learn/synchronizing-with-effects#step-3-add-cleanup-if-needed">react.dev/learn/synchronizing-with-effects#step-3-add-cleanup-if-needed</a> (<a href="https://web.archive.org/web/20240720100401/https://react.dev/learn/synchronizing-with-effects#step-3-add-cleanup-if-needed">archive</a>) which says "you need to cleanup the thing yourself". <a href="https://web.archive.org/web/20240720100401/https://react.dev/learn/synchronizing-with-effects#subscribing-to-events">web.archive.org/web/20240720100401/https://react.dev/learn/synchronizing-with-effects#subscribing-to-events</a> is also says that for the specific case of <code>addEventListener</code>.</div><div class="p" id="_157">But that's annoying! Can't we just somehow tell if we applied twice or not to avoid having to implement a cleanup? What if a third party system does not provide a cleanup at all?</div><div class="p" id="_158">Is the correct solution to just just have a <a href="#useeffect"><code>useEffect</code></a> with empty dependency list? Seems to be good according to posts and to <a href="programming-language#eslint">ESLint</a>!</div><div class="p" id="_159">Tried to do a <a href="">React</a> only reproduction at: <a href="#_file/react/ref-twice.html">react/ref-twice.html</a>.</div><div class="p" id="_160">Bibliography:<div class="list"><ul id="_161"><li id="_162"><a href="https://github.com/facebook/react/issues/8619">github.com/facebook/react/issues/8619</a></li><li id="_163"><a href="https://github.com/vercel/next.js/tree/276fd521d04b6c228d5637ce359220ffa8f62a2f/examples/with-three-js">github.com/vercel/next.js/tree/276fd521d04b6c228d5637ce359220ffa8f62a2f/examples/with-three-js</a></li><li id="_164"><a href="https://www.reddit.com/r/reactjs/comments/tbt2z8/comment/lizezgd/">www.reddit.com/r/reactjs/comments/tbt2z8/comment/lizezgd/</a></li></ul></div></div><div class="p" id="_165"><a href="ciro-santilli">Ciro Santilli</a>'s questions:<div class="list"><ul id="_166"><li id="_167"><a href="https://stackoverflow.com/questions/78891187/how-to-prevent-a-react-useeffect-from-running-twice-in-strictmode-development-wi">stackoverflow.com/questions/78891187/how-to-prevent-a-react-useeffect-from-running-twice-in-strictmode-development-wi</a></li><li id="_168"><a href="https://www.reddit.com/r/reactjs/comments/1ewprza/how_to_prevent_a_react_useeffect_from_running/">www.reddit.com/r/reactjs/comments/1ewprza/how_to_prevent_a_react_useeffect_from_running/</a></li></ul></div></div><div class="h" id="_file/nodejs/next/inject-into-static"><div class="notnav"><span class="file" title="This article is about a file." /><h4><a href="_file/nodejs/next/inject-into-static">nodejs/next/inject-into-static</a></h4><span class="hover-meta"> <a class="split" href="_file/nodejs/next/inject-into-static"></a><span class="metrics"><span class="wcntr"> Words: 24</span></span></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#next-js-example" class="u"> Next.js example</a><a href="#_toc/_file/nodejs/next/inject-into-static" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/_file/nodejs/next/inject-into-static"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a></div><div class="nav file"><b> <a href="_dir">(root)</a> / <a href="_dir/nodejs">nodejs</a> / <a href="_dir/nodejs/next">next</a> / <a href="_dir/nodejs/next/inject-into-static">inject-into-static</a></b></div></nav></div><div class="p" id="_169">In this example we attempt to inject <a href="">React</a> elements into statically rendered HTML coming from the server, and properly hydrate them.</div><div class="p" id="_170">Questions by <a href="ciro-santilli">Ciro Santilli</a>:<div class="list"><ul id="_171"><li id="_172"><a href="https://stackoverflow.com/questions/78892868/how-to-inject-a-react-component-inside-static-pre-rendered-html-coming-from-the">stackoverflow.com/questions/78892868/how-to-inject-a-react-component-inside-static-pre-rendered-html-coming-from-the</a></li><li id="_173"><a href="https://www.reddit.com/r/nextjs/comments/1ewwea3/how_to_inject_a_react_component_inside_static/">www.reddit.com/r/nextjs/comments/1ewwea3/how_to_inject_a_react_component_inside_static/</a></li><li id="_174"><a href="https://github.com/vercel/next.js/discussions/69099">github.com/vercel/next.js/discussions/69099</a></li></ul></div></div><div class="p" id="_175">Bibliography:<div class="list"><ul id="_176"><li id="_177"><a href="https://stackoverflow.com/questions/76489919/nextjs-custom-component-hydration">stackoverflow.com/questions/76489919/nextjs-custom-component-hydration</a></li><li id="_178"><a href="https://stackoverflow.com/questions/67915232/how-to-use-domparser-in-next-js">stackoverflow.com/questions/67915232/how-to-use-domparser-in-next-js</a></li></ul></div></div><div class="h" id="node-express-sequelize-next-js-realworld-example-app"><div class="notnav"><h3><a href="node-express-sequelize-next-js-realworld-example-app">Node Express Sequelize Next.js realworld example app</a></h3><span class="hover-meta"> <a class="split" href="node-express-sequelize-next-js-realworld-example-app"></a></span></div><nav class="h-nav h-nav-toplevel"><div class="nav"><a href="#next-js" class="u"> Next.js</a><a href="#_toc/node-express-sequelize-next-js-realworld-example-app" class="toc"></a><a href="https://ourbigbook.com/cirosantilli/node-express-sequelize-next-js-realworld-example-app"><img src="_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a><span class="tags"> Tags: <a href="web-technology#gothinkster-realworld-implementation">Gothinkster/realworld implementation</a></span></div></nav></div><div class="p" id="_180"><a href="https://github.com/cirosantilli/node-express-sequelize-nextjs-realworld-example-app">github.com/cirosantilli/node-express-sequelize-nextjs-realworld-example-app</a></div><h2 id="_ancestors"><a href="#_ancestors"><span class="fa-solid-900 icon"></span> Ancestors <span class="meta">(10)</span></a></h2><div class="list"><ol><li><a href="web-technology#list-of-front-end-web-frameworks">List of front-end web frameworks</a></li><li><a href="web-technology#front-end-web-framework">Front-end web framework</a></li><li><a href="web-technology#web-framework">Web framework</a></li><li><a href="web-technology">Web technology</a></li><li><a href="software">Software</a></li><li><a href="computer">Computer</a></li><li><a href="technology#information-technology">Information technology</a></li><li><a href="technology#area-of-technology">Area of technology</a></li><li><a href="technology">Technology</a></li><li><a href="."><span title="Home" class="fa-solid-900 icon"></span> Home</a></li></ol></div><h2 id="_incoming-links"><a href="#_incoming-links"><span title="Incoming links" class="fa-solid-900 icon"></span> Incoming links <span class="meta">(12)</span></a></h2><div class="list"><ul><li><a href="#_file/nodejs/next/inject-into-static">nodejs/next/inject-into-static</a></li><li><a href="#_file/nodejs/next/posts">nodejs/next/posts</a></li><li><a href="#_file/nodejs/next/ref-twice">nodejs/next/ref-twice</a></li><li><a href="programming-language#django-web-framework">Django (web-framework)</a></li><li><a href="web-technology#gothinkster-realworld">Gothinkster/realworld</a></li><li><a href="web-technology#gothinkster-realworld-implementation">Gothinkster/realworld implementation</a></li><li><a href="node-js#meteor-web-framework">Meteor (web framework)</a></li><li><a href="node-js#randyscotsmithey-feathers-realworld-example-app">Randyscotsmithey/feathers-realworld-example-app</a></li><li><a href="programming-language#ruby-on-rails-react-integration">Ruby on Rails React integration</a></li><li><a href="node-js#sails-js">Sails.js</a></li><li><a href="updates#how-the-tech-improved">How the tech improved</a></li><li><a href="#useeffect"><code>useEffect</code></a></li></ul></div><h2 id="_synonyms"><a href="#_synonyms"><span title="Synonyms" class="fa-solid-900 icon"></span> Synonyms <span class="meta">(2)</span></a></h2><div class="list"><ul><li><a href="">React (JavaScript library)</a></li><li><a href="">React.js</a></li></ul></div>
</main>
<footer>
<div>Powered by <a href="https://docs.ourbigbook.com">OurBigBook</a></div>
<div>License: <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> unless noted</div>
<div><a href="https://github.com/cirosantilli/cirosantilli.github.io/issues">Suggestions and corrections</a></div>
<div><a href="contact">Contact Ciro Santilli</a></div>
<div><a href="_dir">Website source code</a></div>
<div><a href="https://github.com/cirosantilli/cirosantilli.github.io">Website source code on GitHub</a></div>
<div><a href="_file/react.bigb">Source code for this page: react.bigb</a></div>
<div><a href="https://github.com/cirosantilli/cirosantilli.github.io/blob/f7dac29d5224c15015eee520ccee15a3adb07b98/react.bigb">Source code for this page on GitHub</a></div>
<div>Cite with: <a href="https://zenodo.org/badge/latestdoi/16453261">this DOI</a></div>
<div><img src="https://raw.githubusercontent.com/cirosantilli/media/master/ID_photo_of_Ciro_Santilli_taken_in_2013_left_eye_200_100.jpg" loading="lazy" alt="ID photo of Ciro Santilli taken in 2013 right eye"></div>
</footer>
<script>
window.ourbigbook_split_headers = true;
window.ourbigbook_html_x_extension = false;
window.ourbigbook_redirect_prefix = "";
</script>
<script src="_obb/dist/ourbigbook_runtime.js"></script><script>ourbigbook_runtime.ourbigbook_runtime()</script><script src="_raw/main.js"></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-47867706-1', 'auto');
ga('send', 'pageview');
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DEE2HEJW9X"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-DEE2HEJW9X');
</script>
<script src="https://giscus.app/client.js"
        data-repo="cirosantilli/cirosantilli.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxNjQ1MzI2MQ=="
        data-category="giscus"
        data-category-id="DIC_kwDOAPsOjc4CZ6zZ"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="dark_high_contrast"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</body>
</html>
