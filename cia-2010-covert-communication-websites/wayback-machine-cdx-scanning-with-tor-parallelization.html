<!doctype html>
<html lang=en>
<head>
<meta charset=utf-8>
<title>CIA 2010 covert communication websites / Wayback Machine CDX scanning with Tor parallelization - Ciro Santilli</title>
<meta property="og:title" content="CIA 2010 covert communication websites / Wayback Machine CDX scanning with Tor parallelization - Ciro Santilli">
<meta property="og:type" content="website">
<meta property="og:image" content="https://raw.githubusercontent.com/cirosantilli/media/master/ID_photo_of_Ciro_Santilli_taken_in_2013_square_398.jpg">
<meta property="og:url" content="https://cirosantilli.com/cia-2010-covert-communication-websites/wayback-machine-cdx-scanning-with-tor-parallelization">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.1/css/all.min.css" integrity="sha512-9my9Mb2+0YO+I4PUCSwUYO7sEK21Y0STBAiFEYoWtd2VzLEZZ4QARDrZ30hdM1GlioHJ8o8cWQiy8IAb1hy/Hg==" crossorigin="anonymous" referrerpolicy="no-referrer">
<link rel="canonical" href="https://ourbigbook.com/cirosantilli/cia-2010-covert-communication-websites/wayback-machine-cdx-scanning-with-tor-parallelization">
<style>@import "../_obb/dist/ourbigbook.css";

</style>
<link rel="stylesheet" type="text/css" href="../_raw/main.css">
<link rel="shortcut icon" type="image/x-icon" href="https://raw.githubusercontent.com/cirosantilli/media/master/ID_photo_of_Ciro_Santilli_taken_in_2013_square_398.jpg">
</head>
<body>
<header>
<div class="brand-group">
<a href="../" class="brand"><img src="https://raw.githubusercontent.com/cirosantilli/media/master/ID_photo_of_Ciro_Santilli_taken_in_2013_right_eye_200_100.jpg" loading="lazy" alt="ID photo of Ciro Santilli taken in 2013 right eye">Ciro Santilli</a>
<a href="https://ourbigbook.com/cirosantilli"><img src="https://raw.githubusercontent.com/cirosantilli/media/master/ourbigbook-logo-v1.svg" loading="lazy" alt="OurBigBook logo">OurBigBook.com</a>
<a class="font-awesome-container" href="https://stackoverflow.com/users/895245"><i class="fab fa-stack-overflow fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://github.com/cirosantilli"><i class="fab fa-github fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://www.linkedin.com/in/cirosantilli"><i class="fab fa-linkedin fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://www.youtube.com/c/CiroSantilli"><i class="fab fa-youtube fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://twitter.com/cirosantilli"><i class="fab fa-twitter fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://www.zhihu.com/people/cirosantilli/activities"><i class="fab fa-zhihu fa-fw icon"></i></a>
<a class="font-awesome-container" href="https://www.weibo.com/p/1005055601627311"><i class="fab fa-weibo fa-fw icon"></i></a>
<a href="../sponsor"><span class="icon">$£</span>&nbsp;Sponsor</a>
<a href="https://github.com/cirosantilli/china-dictatorship"><span class="icon">中国</span>独裁统治&nbsp;China Dictatorship 新疆改造中心、六四事件、法轮功、郝海东、709大抓捕、2015巴拿马文件 邓家贵、低端人口、西藏骚乱</a>
</div>
</header>
<main class="ourbigbook">
<div class="h top" id="wayback-machine-cdx-scanning-with-tor-parallelization"><div class="notnav"><h1><a href="../cia-2010-covert-communication-websites">CIA 2010 covert communication websites</a><span class="meta"> / </span><a href="">Wayback Machine CDX scanning with Tor parallelization</a></h1></div><nav class="h-nav h-nav-toplevel"><div class="nav ancestors"><a  href="#_ancestors">&nbsp;...</a><a href="../science#central-intelligence-agency"> Central Intelligence Agency</a><a href="../cia-2010-covert-communication-websites"> CIA 2010 covert communication websites</a><a href="../cia-2010-covert-communication-websites#methodology"> Methodology</a><a href="../cia-2010-covert-communication-websites#data-sources"> Data sources</a><a href="../cia-2010-covert-communication-websites#wayback-machine"> Wayback Machine</a><a href="../cia-2010-covert-communication-websites#wayback-machine-cdx-scanning"> Wayback Machine CDX scanning</a></div><div class="nav"><a href="https://ourbigbook.com/cirosantilli/cia-2010-covert-communication-websites/wayback-machine-cdx-scanning-with-tor-parallelization"><img src="../_obb/logo.svg" class="logo" alt=""> OurBigBook.com</a><a class="nosplit" href="../cia-2010-covert-communication-websites#wayback-machine-cdx-scanning-with-tor-parallelization"></a><span class="metrics"><span class="wcntr"> Words: 337</span></span></div></nav></div><div class="p" id="_5985">Dire times require dire methods: <a href="../_raw/cia-2010-covert-communication-websites/cdx-tor.sh">cia-2010-covert-communication-websites/cdx-tor.sh</a>.</div><div class="p" id="_5986">First we must start the tor servers with the <code>tor-army</code> command from: <a href="https://stackoverflow.com/questions/14321214/how-to-run-multiple-tor-processes-at-once-with-different-exit-ips/76749983#76749983">stackoverflow.com/questions/14321214/how-to-run-multiple-tor-processes-at-once-with-different-exit-ips/76749983#76749983</a><div class="code" id="_5987"><div><pre><code>tor-army 100</code></pre></div></div>and then use it on a newline separated domain name list to check;<div class="code" id="_5988"><div><pre><code>./cdx-tor.sh infile.txt</code></pre></div></div>This creates a directory <code>infile.txt.cdx/</code> containing:<div class="list"><ul id="_5989"><li id="_5990"><code>infile.txt.cdx/out00</code>, <code>out01</code>, etc.: the suspected CDX lines from domains from each tor instance based on the simple criteria that the CDX can handle directly. We split the input domains into 100 piles, and give one selected pile per tor instance.</li><li id="_5991"><code>infile.txt.cdx/out</code>: the final combined CDX output of <code>out00</code>, <code>out01</code>, ...</li><li id="_5992"><code>infile.txt.cdx/out.post</code>: the final output containing only domain names that match further CLI criteria that cannot be easily encoded on the CDX query. This is the cleanest domain name list you should look into at the end basically.</li></ul></div></div><div class="p" id="_5993">Since archive is so abysmal in its data access, e.g. a <a href="../google#google-bigquery">Google BigQuery</a> would solve our issues in seconds, we have to come up with creative ways of getting around their IP throttling.</div><div class="p" id="_5994">The <a href="../science#central-intelligence-agency">CIA</a> doesn't play fair. They're actually the exact opposite of fair. So neither shall we.</div><div class="p" id="_5995">Distilled into an answer at: <a href="https://stackoverflow.com/questions/14321214/how-to-run-multiple-tor-processes-at-once-with-different-exit-ips/76749983#76749983">stackoverflow.com/questions/14321214/how-to-run-multiple-tor-processes-at-once-with-different-exit-ips/76749983#76749983</a></div><div class="p" id="_5996">This should allow a full sweep of the 4.5M records in <a href="../cia-2010-covert-communication-websites#2013-dns-census-virtual-host-cleanup">2013 DNS Census virtual host cleanup</a> in a reasonable amount of time. After JAR/SWF/CGI filtering we obtained 5.8k domains, so a reduction factor of about 1 million with likely very few losses. Not bad.</div><div class="p" id="_5997">5.8k is still a bit annoying to fully go over however, so we can also try to count CDX hits to the domains and remove anything with too many hits, since the CIA websites basically have very few archives:<div class="code" id="_5998"><div><pre><code>cd 2013-dns-census-a-novirt-domains.txt.cdx
./cdx-tor.sh -d out.post domain-list.txt
cd out.post.cdx
cut -d' ' -f1 out | uniq -c | sort -k1 -n | awk 'match($2, /([^,]+),([^)]+)/, a) {printf("%s.%s %d\n", a[2], a[1], $1)}' &gt; out.count</code></pre></div></div>This gives us something like:<div class="code" id="_5999"><div><pre><code>12654montana.com 1
aeronet-news.com 1
atohms.com 1
av3net.com 1
beechstreetas400.com 1</code></pre></div></div>sorted by increasing hit counts, so we can go down as far as patience allows for!</div><div class="p" id="_6000">New results from a full CDX scan of 2013-dns-census-a-novirt.csv:<div class="list"><ul id="_6001"><li id="_6002">219.90.61.123 journeystravelled.com</li></ul></div></div><h2 id="_ancestors"><a href="#_ancestors"><span class="fa-solid-900 icon"></span> Ancestors <span class="meta">(16)</span></a></h2><div class="list"><ol><li><a href="../cia-2010-covert-communication-websites#wayback-machine-cdx-scanning">Wayback Machine CDX scanning</a></li><li><a href="../cia-2010-covert-communication-websites#wayback-machine">Wayback Machine</a></li><li><a href="../cia-2010-covert-communication-websites#data-sources">Data sources</a></li><li><a href="../cia-2010-covert-communication-websites#methodology">Methodology</a></li><li><a href="../cia-2010-covert-communication-websites">CIA 2010 covert communication websites</a></li><li><a href="../science#central-intelligence-agency">Central Intelligence Agency</a></li><li><a href="../science#american-intelligence-agency">American intelligence agency</a></li><li><a href="../science#united-states-intelligence-community">United States Intelligence Community</a></li><li><a href="../science#intelligence-community">Intelligence community</a></li><li><a href="../science#secret-service">Secret service</a></li><li><a href="../science#espionage">Espionage</a></li><li><a href="../science#war">War</a></li><li><a href="../science#social-science">Social science</a></li><li><a href="../science#scientific-method">Scientific method</a></li><li><a href="../science">Science</a></li><li><a href=".."><span title="Home" class="fa-solid-900 icon"></span> Home</a></li></ol></div><h2 id="_incoming-links"><a href="#_incoming-links"><span title="Incoming links" class="fa-solid-900 icon"></span> Incoming links <span class="meta">(2)</span></a></h2><div class="list"><ul><li><a href="../cia-2010-covert-communication-websites#expired-domain-trackers">Expired domain trackers</a></li><li><a href="../cia-2010-covert-communication-websites#overview-of-ciro-santilli-s-investigation">Overview of Ciro Santilli's investigation</a></li></ul></div>
</main>
<footer>
<div>Powered by <a href="https://docs.ourbigbook.com">OurBigBook</a></div>
<div>License: <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> unless noted</div>
<div><a href="https://github.com/cirosantilli/cirosantilli.github.io/issues">Suggestions and corrections</a></div>
<div><a href="../contact">Contact Ciro Santilli</a></div>
<div><a href="../_dir">Website source code</a></div>
<div><a href="https://github.com/cirosantilli/cirosantilli.github.io">Website source code on GitHub</a></div>
<div><a href="../_file/cia-2010-covert-communication-websites.bigb">Source code for this page: cia-2010-covert-communication-websites.bigb</a></div>
<div><a href="https://github.com/cirosantilli/cirosantilli.github.io/blob/a4d833d32a963800b7b90b69207f6802c6bb72d2/cia-2010-covert-communication-websites.bigb">Source code for this page on GitHub</a></div>
<div>Cite with: <a href="https://zenodo.org/badge/latestdoi/16453261">this DOI</a></div>
<div><img src="https://raw.githubusercontent.com/cirosantilli/media/master/ID_photo_of_Ciro_Santilli_taken_in_2013_left_eye_200_100.jpg" loading="lazy" alt="ID photo of Ciro Santilli taken in 2013 right eye"></div>
</footer>
<script>
window.ourbigbook_split_headers = true;
window.ourbigbook_html_x_extension = false;
window.ourbigbook_redirect_prefix = "cia-2010-covert-communication-websites/";
</script>
<script src="../_obb/dist/ourbigbook_runtime.js"></script><script>ourbigbook_runtime.ourbigbook_runtime()</script><script src="../_raw/main.js"></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-47867706-1', 'auto');
ga('send', 'pageview');
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DEE2HEJW9X"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-DEE2HEJW9X');
</script>
<script src="https://giscus.app/client.js"
        data-repo="cirosantilli/cirosantilli.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxNjQ1MzI2MQ=="
        data-category="giscus"
        data-category-id="DIC_kwDOAPsOjc4CZ6zZ"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="dark_high_contrast"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</body>
</html>
